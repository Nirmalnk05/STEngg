Remaining useful life (RUL) prediction for FDIA on IoT sensor data using CNN and GRU
https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9732743

Shipra Singh
Computer Science & Engineering
Kaptan Singh
Computer Science & Engineering
Amit Saxena
Computer Science & Engineering
RGPV, Bhopal, India RGPV, Bhopal, India RGPV, Bhopal, India
Shiprasingh2011@gmail.com kaptan2007@gmail.com amitsaxena@trubainstitute.ac.in


Abstract—The industrial Internet of Things (IIoT) is the use
of Internet of Things (IoT) technologies in manufacturing
which tackles smartly the machine data generated by various
sensors and applies various analytics on it to gain useful
information. Predictive maintenance (PdM) is a method of
preventing asset failure by analyzing production data and
identifying patterns to predict issues before they happen.
IoT Sensor nodes are also vulnerable to different threats and
attacks, which primarily include false data injection attack
(FDIA). This paper predicts the accurate remaining useful
life (RUL) of IoT device through industrial predictive
maintenance (PdM) and exhibits the effect of FDIA on a
PdM system through convolutional neural network (CNN)
and gated recurrent unit (GRU), for predicting the RUL
using the C-MAPSS dataset of a turbo fan engine and gives
their comparative result.
Keywords—Internet of things, PdM, false data injection
attack, RUL, CNN, GRU.

I. INTRODUCTION
 Now a days, Internet of Things (IoT) is used for the
networking of smart objects via the internet so that
connected objects communicate with each other, and
provide services without the need for inter-human or
human-to- computer interaction [1]. The number of devices
connected to the internet and to each other are continuously
growing days by days and will reach the value of 41.6
billion in 2025. IoT integrates various sensors and objects
that directly communicate with each other without human
intervention [2]. These all light weighted sensor nodes
communicates to each other via the internet and hence, they
should satisfy the basic parameters like secrecy,
trustworthiness, verification, and non-revocation [4],[5] .
 A sensor node gather the data, process them and
interconnect with another nodes in the network. Sensor
nodes are flexible and have high latency while
communication. These nodes are also vulnerable to different
threats and attacks, which primarily include false data
injection (FDIA), node failures, passive information
collection, false node message corruption, tampering, and
many more.

 IoT devices are suffered from power analysis
attack through injecting false data. Power analysis is also
able to provide critical encrypting parameters to attackers.
These information may be used for false data encryption by
replacing the data with the original data on devices.
Attackers are able to inject false encrypted data to perform
harmful actions in the communication network, and thus
change the performance of IoT devices. Sensor-based
threats may be active and passive both. Passive threats are
like observing the behavior of the IoT device without
blocking their normal behaviour, and active threats are like
FDIA and inserting malicious codes to the device sensed
data. Based on the purpose and nature of the threats, sensorbased threats in IoT devices are categorized into four
categories as shown in figure 1.
Fig 1. IoT Sensor Threats

 In the context of IoT devices and applications,
information leakage is a common sensor-based threat.
Which is forced by inference of any keystrokes, tasks,
location, and many more. IoT sensor devices is also used to
transmit malicious sensor patterns and commands to process
malware activities that can harm the user device. Attackers
are able to send trigger messages and thus infect the device
with malwares through controlling the voltage. In FDIA,
attackers are able to change the IoT applications forcefully
and compelled them to do malicious activities. In denial-ofService (DoS), a normal application is denied forcefully so
that no one can take the services. This attack can also stop
another process which is already going on.
 Various Deep Learning approaches like CNN,
GRU, Long Short-Term Memory (LSTM) are proposed and
designed till today in terms of classification and regression.
Several layers and many neurons allow the abstraction of
complex problems and provide more accuracy with respect
to fault diagnosis with this approach. But, IoT sensors as
well as deep learning approaches, both are very sensitive to
cyber-attacks and to various threats due to their disastrous
impacts in PdM system. Nature of these kind of attacks and
threats are also very difficult to recognize [1].
 The predictive maintenance (PdM) refers to the
enhancement of condition-based maintenance through
automated monitoring of the industrial installation,
combined with statistical evaluation of the recorded data and
the forecast of future disturbance events. PdM is a method
of preventing asset failure by analyzing production data and
identifying patterns to predict issues before they happen.
According to the above definition [8], predictive
maintenance can be represented as a four-phase control loop
as shown in below figure 2. 
Remaining useful life (RUL) is a very important
parameter, which evaluates real time estimation of life of a
device till it cannot be replaced by new one. So, it is very
needed to predict the accurate RUL of device through
Industrial PdM. This paper exhibits the effect of false data
injection attack on a PdM system through Convolutional
Neural Network (CNN) and Gated Recurrent Unit (GRU),
for predicting the RUL using the C-MAPSS dataset of a
turbo fan engine and gives their comparative result.
 Paper organization: In the reaming part of the
paper, section II reviews the previous related work of the
predicting industrial IOT sensor threats related to FDIA and
in section III, proposed methods and results are shown.
Section IV gives the comparative study of performance of
GRU, and CNN for RUL prediction. Section V gives the
conclusion of this paper. 

II. RELATED WORK
 There are many researchers, who have already
worked on PdM system to predict the IoT threats by
evaluating RUL and other parameters for IIoT. This section
sequentially reviewed the related work in this domain.
Gautam Raj Mode et al. in [1] have shown affect of FDIA
on a PdM system. They have predicted the RUL value of a
turbofan engine using NASA’s C-MAPSS dataset by using
some deep learning techniques like long short-term memory,
GRU, and CNN. They have clearly shown that their GRUbased PdM model performs outstanding in predicting the
RUL parameter using the C-MAPSS dataset. They have
tested their model by applying two FDI attacks i.e.
continuous and interim on turbofan engine sensor data set
and evaluated their impact factor on PdM systems that is
based on CNN, LSTM, and GRU. They have concluded that
FDIAs affect the prediction of RUL parameter for all cases
and for any number of IoT sensors, as well as GRU-based
PdM model also performs much better to FDIA in respect of
accuracy and flexibility. For the GRU-based PdM models,
they have also established the relationship among the
accuracy, resiliency and sequence length parameters.
Abdellah Chehri and Gwanggil Jeon in [8] have proposed
an efficient framework for the industrial IoT, which
provides a futuristic approach for their applications. They
have represented the predictive maintenance as an important
building block of the smart industry, which enhances the
productivity and minimizes the downtime. In aspect of highquality systems, high availability requires timely repair in
the event of a breakdown. An ideal would thus be either the
failsafe operation, which is practically impossible to realize
in practice or the reliable prediction of damage events to the
necessary means of maintenance to stockpile as needed.
Adnan Akbar et al. in [10] have designed an adaptive
prediction approach for dynamic IoT data, which is also
called adaptive moving window regression (AMWR) and it
is also evaluated by using a real-world use case having an
accuracy of more than 96%. Their model also predicts
accurately in real-time and can work along CEP in their
architecture. They have also implemented their proposed
design by using open source components which are
optimized for big data applications and they have also
validated their model on a use-case from intelligent
transportation systems (ITS). Their architecture is more
reliable and can also be used to predict complex events
across different fields. They have designed a generic
architecture which combines ML with CEP in order to
predict complex events for proactive IoT applications. They
have also modelled the error generated by their prediction
algorithm by using a parametric distribution and designed
formulas for the overall error of the system, when the error
propagates through the CEP.
Ana Cachada et al. in [11] have proposed an intelligent
and predictive maintenance system architecture that is
aligned with Industry 4.0 principles, and it detects earlier the
occurrence of possible machine failures by analyzing with
new and advance online techniques on the collected data,
and also provides better assistance to staffs and technicians
during the maintenance interventions by providing a guided
intelligent decision support. Their paper has analysed
collected data and detect faults and gives alert signal.
Michele Compare et al. in [12] have given a brief
description of challenges and opportunities in the field of
maintenance area having PDM issues with their research
and literature. They have given idea about various issues for
developing IoT enabled PdM in factories. This paper
concludes that PdM value chain is enough longer to collect
the data. They have also briefly discussed about importance
of designing and developing integrated PDM model. 

Ameeth Kanawaday et al. in [13] They have concluded
that IoT based machine learning will help overcome major
limitations in productivity and maintenance costs associated
with IIoT. The first stage of their proposed model is data
analysis, clustering and supervised learning techniques to
extract the information. Second stage uses regressive
integrated moving average (ARIMA) forecasting to add
PDM models. Their model collects generated data from
Slitting Machine and predicts the different events and
improves the production process. This paper concludes that
productivity can be increased, and maintenance costs can be
decreased by using IoT based machine learning.
Ajay Shrestha et al. in [16] have provided the literature of
various methods, which decreases the training time and
increases the training accuracy of data in deep networks.
They have also reviewed various deep architectures (i.e.
deep convolution networks, deep residual networks,
recurrent neural networks, reinforcement learning),
advantages, disadvantages and implementations. This paper
gives ideas to overcome different challenges by using
optimization methods.
Mohammed Ali Al-Garadi et al. in [17] surveyed various
machine learning techniques and deep learning methods,
which enhances security approaches for IoT. They have
discussed various security threats, various possible IoT
attacks to all surfaces. This paper also gives the detailed
comparative description about challenges, advantages and
opportunities of ML/DL methods, which are used for secure
IoT system. They also describe issues and challenges, which
arise in using ML/DL methods to secure IoT system.
Mariam M. N. Aboelwafa et al. in [18] have proposed a
unique approach to detect FDI attack using auto encoders as
a classification approach. Their proposed model identify
falsified data and presents correlation between time and
spatial dimensions. Their method performs better in respect
of support vector machine based approach used for the same
purpose and also detects FDI attacks. Their model recovers
the tentative correlation structure and then auto encodes are
used to clean the falsify data. They have also proved that
their model successfully cleans the corrupted data by
denoising autoencoders.
Dajian Huang et al. in [19] have designed a new datadriven intrusion detection model. Their model is based on
frequency and time domain analysis, which only uses
measurements of IoT sensors in closed-loop control. Firstly
they have extracted features, then established hidden
Markov models , furthermore, they have provided training
to hidden Markov models utilized to detect real-time
intrusions. Their model has been also proved their
effectiveness by their experimental results.
Hosam Hittini et al. in [21] have designed a new protocol
that prevents false data injection attacks in smart grid
distribution systems. Their model name is data injection
prevention protocol (FDIPP), which works on unique
hierarchical communication network architecture. Their
proposed protocol preserves system and data integrity and
prevents packet injection, duplication of nodes, alteration of
nodes, and access of corrupted nodes. It can be used to
prevent the damage of power network assets of power grid.
Their model is also scalable and reduces packet delay during
communication. 

III. EXPRIMENT & RESULTS
The proposed work of this paper has been implemented on
the C-MAPSS dataset having sample set of 21 with 3
settings. Our work has been implemented in python on GPU
with CNN and GRU (regression model), for finding the best
predicted RUL against true RUL, for the FDIA injected data
set in industries. Configuration of CNN and GRU is
described in table 1 and table 2 respectively.
The work experiment has been carried out on both the
model and found fine approximated predicted RUL with
True RUL for both the model. The comparison of both the
model has been carried out on the given parameter shown in
table 3.
The graphs of both the techniques (CNN & GRU), which
are prepared on two parameters of engine id on X label and
RUL cycles on Y label, are shown in figure 3 & 4. 

Table 1. CNN Configuration
Layer (type) Output Shape Param #
batch_normalization_2 (None, 100, 25) 100
conv1d_8 (Conv1D (None, 98, 64) 4864
conv1d_9 (Conv1D) (None, 96, 64) 12352
conv1d_10 (Conv1D) (None, 94, 64) 12352
conv1d_11 (Conv1D) (None, 92, 64) 12352
flatten_2 (Flatten) (None, 5888) 0
dense_7 (Dense) (None, 40) 235560
activation_7 (Activation) (None, 40) 0
dense_8 (Dense) (None, 30) 1230
activation_8 (Activation) (None, 30) 0
dense_9 (Dense) (None, 1) 31
After configuration of CNN, following parameters (trainable
and non trainable) has been found and the value are given
below:
Total Params: 278,841
Trainable Params: 278,791
Non-trainable Params: 50 

Table 2. GRU Configuration
Layer (type) Output Shape Param
#
gru_4 (GRU) (None, 80, 100) 38100
dropout_4 (Dropout) (None, 80, 100) 0
gru_5 (GRU) (None, 80, 100) 60600
dropout_5 (Dropout) (None, 80, 100) 0
gru_6 (GRU) (None, 80, 100) 60600
dropout_6 (Dropout) (None, 80, 100) 0
gru_7 (GRU) (None, 100) 60600
dropout_7 (Dropout) (None, 100) 0
dense_13 (Dense) (None, 1) 101
activation_13 (Activation) (None, 1) 0
After configuration of GRU, following parameters (trainable
and non trainable) has been found and the value are given
below:
Total Params: 220,001
Trainable Params: 220,001
Non-trainable Params: 0 


It is observed that graphs (figure 3 & 4) of both the
techniques are somehow been seen similar. But, differences
among them can be analyzed against some statistical
parameters like root mean square error (RSME), loss, Rsquared (R2
), and parameters (param). The given table 4
shows the comparison between the CNN model and GRU
based on RSME, loss, R2
, and param of the proposed
model. From the table it is clear that value of RSME, loss
and times per step is less for GRU compared to CNN. But
the value of R2
 is more for GRU compared to CNN.
 
 It is clearly shown that GRU is a optimized method for
proposed scenario of FDIA effected industries from table 3
and figure 5. Above mentioned parameters show that the
regression techniques based on GRU is better than CNN,
having same set of predicted RUL and the true RUL. Graphs
also shows that the no of RUL in cycles are approximate
same as in CNN.
The above results clearly shows that the GRU based model
for predicting RUL is quick and accurate against the false
data injection attacks on sensors dataset in industries. The
result shows that if a FDIA attack is being predicted
accurate then a industry can prevent loss of their resources
against attack. The graphs in figure 3 and 4 shows that
predicted RUL and true RUL is very close in case of GRU
and CNN both, and that means more chance to avoid the
attacks and prevent any industry automotive resource
system.
CONCLUSION
This paper predicts and compares the performance of GRU,
and CNN for RUL prediction using the C-MAPSS dataset,
and shows the impacts on FDI attacks on these deep
learning (DL) algorithms. This is shown that the GRU is a
better suited DL technique when compared to CNN in terms
of accuracy. The obtained results show that FDIA have a
substantial impact on the RUL prediction even if only a few
IoT sensors are attacked. We have also observed that the
GRU-based model is more effective to FDIA, whereas CNN
is dramatically sensitive to FDIA on continuous data. GRU
model with specific configuration provides the significant
results compared to CNN.
ACKNOWLEDGMENT
 Authors acknowledge every individual responsible to
make the work success directly or indirectly, Authors
acknowledges Institute for providing the all facility to make
the research success. All the referred authors are also
acknowledged.
REFERENCES
[1] Gautam Raj Mode, Prasad Calyam, Khaza Anuarul Hoque,
"Impact of False Data Injection Attacks on Deep Learning Enabled
Predictive Analytics", IEEE, pp. 1-7, 2020.
[2] W.Z. Khan, M.H. Rehman, H.M. Zangoti, M.K. Afzal, N. Armi
, K. Salah, "Industrial internet of things: Recent advances, enabling
technologies and open challenges", Elsevier, pp. 1-13, 2019.
[3] Ilaria Torre, Frosina Koceva, Odnan Ref Sanchez, Giovanni
Adorni, "A Framework for Personal Data Protection in the loT",
IEEE, pp. 384-391, 2016.
[4] Fadele Ayotunde Alabaa, Mazliza Othmana, Ibrahim Abaker
Targio Hashema, Faiz Alotaibi, "Internet of Things security: A
survey", Elsevier, pp. 1-19, 2017.
[5] Johannes Kölsch, Carna Zivkovic, Yajuan Guan, and Christoph
Grimm, "An Introduction to the Internet of Things", Springer, pp.
1-19, 2020.
[6] Campbell Rehu, Firas Al-Ali, "Internet of Things: Survey,
Observations & Future Trends", CITRENZ, pp. 1-9, 2017.
[7] P.P. Ray, "A survey on Internet of Things architectures",
Journal of King Saud University Computer and Information
Sciences, pp. 291-317, 2016.
[8] Abdellah Chehri and Gwanggil Jeon, "The Industrial Internet of
Things: Examining How the IIoT Will Improve the Predictive
Maintenance", Springer, pp. 517-527, 2019.
[9] Yongyi Ran, Xin Zhou, Pengfeng Lin, Yonggang Wen,
Ruilong Deng, "A Survey of Predictive Maintenance: Systems,
Purposes and Approaches", IEEE communications surveys &
tutorials, pp. 1-36, 2019.
[10] Adnan Akbar, Abdullah Khan, Francois Carrez, and Klaus
Moessner, "Predictive Analytics for Complex IoT Data Streams",
IEEE Internet Of Things Journal, pp. 1-12, 2017.
[11] Ana Cachada, José Barbosa, Paulo Leitão, Carla A. S.
Geraldesyz, Leonel Deusdadoy, Jacinta Costa, "Maintenance 4.0:
Table 3. Comparison between CNN and Proposed GRU
Parameter/Techniques RSME Loss    R^2    Timeperstep NonTrainableParams
CNN                 9.947 195.354 0.7872  3ms          50
GRU                 5.468 64.4873 0.9529 2ms            0
The parameters value has been noted with the batch size
1024 of the dataset. Figure 5 shows the Comparative result
for predicting RUL by CNN and GRU techniques in the form
of bar chart.

activation_9 (Activation) (None, 1) 0
